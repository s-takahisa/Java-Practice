
##問6
##EMPLOYEE_MSTテーブルをemMst、emEnrをEMPLOYEE_ENROLLMENT
##翌月に入社日付が存在しない場合、
SELECT emMst.EMPLOYEE_ID, emMst.EMPLOYEE_NM,
		CONCAT(TIMESTAMPDIFF(YEAR,emEnr.ENTERING_DATE,'2017-04-1'),"年",
				   TIMESTAMPDIFF(MONTH,emEnr.ENTERING_DATE,'2017-04-1')%12,"ヵ月")AS ENROLLMENT_PERIOD_YM
	FROM EMPLOYEE_MST emMst INNER JOIN EMPLOYEE_ENROLLMENT emEnr ON emMst.EMPLOYEE_ID = emEnr.EMPLOYEE_ID
	WHERE emEnr.RETIRED_FLG = 0	
	##在籍期間は0年0ヵ月から顔える（入社日2017/3/15→2017/4/1時点での在籍期間
##並び順の第一優先は「月に換算した在籍期間」
ORDER BY TIMESTAMPDIFF(MONTH , emEnr.ENTERING_DATE , '2017-04-01') ,emMst.EMPLOYEE_ID ;
		 
